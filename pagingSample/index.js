(()=>{"use strict";var y={},d=(s,t,n)=>new Promise((e,o)=>{var i=r=>{try{a(n.next(r))}catch(l){o(l)}},c=r=>{try{a(n.throw(r))}catch(l){o(l)}},a=r=>r.done?e(r.value):Promise.resolve(r.value).then(i,c);a((n=n.apply(s,t)).next())});function g(s){if(s.type==="opaqueredirect"&&s.url!==""&&(location.href=s.url),!s.headers.has("refresh"))return;const t=s.headers.get("refresh");if(t===null)return;const n=/url=(.+)$/;if(n.test(t)){const e=t.match(n);if(e===null)return;location.href=e[1]}}function h(s,t,n){const e=document.createEvent("CustomEvent");e.initCustomEvent(t,!1,!1,n);const o=document.getElementById(s);if(o===null)throw new Error("mandatory element not found");o.dispatchEvent(e)}function N(s){return fetch(s).then(t=>(g(t),new Promise((n,e)=>{t.ok?n(t.json()):e(t.statusText)}))).then(t=>new Promise((n,e)=>{t.status==="ok"?n(t):e(t)}))}function x(s){return d(this,null,function*(){const t=yield fetch(s);if(g(t),!t.ok)throw t;const n=yield t.json();if(n.status!=="ok")throw n;return n})}function v(s,t,n){return d(this,null,function*(){try{const e=new FormData(s),o=new Request(t,{body:e,credentials:"include",method:"POST",redirect:"manual"});E(n);const i=yield x(o);return m(n),i}catch(e){throw m(n),e}})}function w(s){return d(this,null,function*(){const t={credentials:"include",method:s.method||"GET",redirect:"manual"};"body"in s&&(t.body=s.body);const n=new Request(s.url,t),e=yield fetch(n);if(g(e),!e.ok)throw e;const o=yield e.json();if(o.status!=="ok")throw o;return o})}function E(s){f(),document.querySelectorAll("."+s).forEach(n=>{n.disabled=!0})}function m(s){f(),document.querySelectorAll("."+s).forEach(n=>{n.disabled=!1})}function f(){"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(s,t){t=t||window;for(let n=0;n<this.length;n++)s.call(t,this[n],n,this)})}class u{constructor(t){this.current=1,this.totalPage=1,this.idObj=t;const n=document.getElementById(this.idObj.pagingTemplate).content,e=document.importNode(n,!0);this.pagingBase=e.querySelector("ul");const o=document.getElementById(this.idObj.pagingTemplateOpen).content,i=document.importNode(o,!0);this.pagingOpen=i.querySelectorAll("li");const c=document.getElementById(this.idObj.pagingTemplateClose).content,a=document.importNode(c,!0);this.pagingClose=a.querySelectorAll("li");const r=document.getElementById(this.idObj.pagingFragmentTemplate).content,l=document.importNode(r,!0);this.pagingFragment=l.querySelector("li"),this.pagingNumberObj={close:0,hasNext:!1,hasNextSibling:!1,hasPrev:!1,hasPrevSibling:!1,open:0},this.setEvent()}static calcPagingNumber(t,n){const e={close:1,hasNext:!1,hasNextSibling:t!==n,hasPrev:!1,hasPrevSibling:t!==1,open:1},o=t%10;return o===0?e.open=t-9:e.open=t-o+1,o===0?e.close=t:(e.close=t+(10-o),e.close>n&&(e.close=n)),e.open>=11&&(e.hasPrev=!0),e.close%10===0?e.close+1<=n&&(e.hasNext=!0):e.close+1<n&&(e.hasNext=!0),e}static calcPrevNextPage(t,n,e){let o=1;return o=t+e,o<=0&&(o=1),o>n&&(o=n),o}setEvent(){const t=document.getElementById(this.idObj.paging);t!==null&&(t.addEventListener("onsearch",n=>{const e=n.detail;console.dir(e),this.current=e.page,this.totalPage=e.totalpage,this.buildPaging(e),this.buildMisc(e)},!1),t.addEventListener("click",n=>{n.preventDefault();const e=n.target;if(!e.classList.contains("page-link"))return;const o={page:1};if(e.classList.contains("isnum"))o.page=Number(e.textContent);else{const i=Number(e.getAttribute("data-add"));o.page=u.calcPrevNextPage(this.current,this.totalPage,i)}h(this.idObj.form,"searchrequest",o)},!1))}buildPaging(t){const n=document.getElementById(this.idObj.pagingWrap);if(n===null)throw new Error("mandator element not found");for(;n.lastChild;)n.removeChild(n.lastChild);const e=document.createDocumentFragment();this.pagingNumberObj=u.calcPagingNumber(t.page,t.totalpage);const o=this.pagingOpen[0].cloneNode(!0);this.pagingNumberObj.hasPrev||o.classList.add("disabled"),e.appendChild(o);const i=this.pagingOpen[1].cloneNode(!0);if(this.pagingNumberObj.hasPrevSibling||i.classList.add("disabled"),e.appendChild(i),this.pagingFragment===null)throw new Error("mandator element not found");for(let l=this.pagingNumberObj.open;l<=this.pagingNumberObj.close;l++){const p=this.pagingFragment.cloneNode(!0),b=p.querySelector("a");if(b===null)throw new Error("mandator element not found");b.textContent=l.toString(),l===t.page&&p.classList.add("active"),e.appendChild(p.cloneNode(!0))}const c=this.pagingClose[0].cloneNode(!0);this.pagingNumberObj.hasNextSibling||c.classList.add("disabled"),e.appendChild(c);const a=this.pagingClose[1].cloneNode(!0);if(this.pagingNumberObj.hasNext||a.classList.add("disabled"),e.appendChild(a),this.pagingBase===null)throw new Error("mandator element not found");const r=this.pagingBase.cloneNode(!0);r.appendChild(e),n.appendChild(r)}buildMisc(t){const n=`\u5168 ${t.total} \u4EF6 (${t.page} / ${t.totalpage} \u30DA\u30FC\u30B8) ${t.perpage} \u4EF6\u305A\u3064\u8868\u793A`,e=document.getElementById(this.idObj.pagingMisc);if(e===null)throw new Error("mandator element not found");e.textContent=n}}document.addEventListener("DOMContentLoaded",()=>{const s={data:[],page:1,perpage:10,total:3,totalpage:1},t={base:{form:"searchform",paging:"paging",pagingFragmentTemplate:"paging_fragment",pagingMisc:"paging_misc",pagingTemplate:"paging_template",pagingTemplateClose:"paging_template_close",pagingTemplateOpen:"paging_template_open",pagingWrap:"paging_wrap",reset:"xxxxxxxxx",search:"xxxxxxxxx",table:"xxxxxxxxx",template:"xxxxx"}};document.querySelectorAll(".buttons button").forEach(i=>{i.addEventListener("click",c=>{const a=c.target,r=a.getAttribute("data-page")||"",l=a.getAttribute("data-total")||"";s.totalpage=Number(l),s.page=Number(r),h("paging","onsearch",s)},!1)});const e=document.getElementById("searchform");if(e===null)throw new Error("mandatory element not found");e.addEventListener("searchrequest",i=>{const c=i.detail,a=i.target.querySelector("input");a!==null&&(a.value=c.page.toString())},!1);const o=new u(t.base)},!1)})();
