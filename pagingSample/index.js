(()=>{"use strict";function e(e,t,n){var a=document.createEvent("CustomEvent");a.initCustomEvent(t,!1,!1,n);var i=document.getElementById(e);if(null===i)throw new Error("mandatory element not found");i.dispatchEvent(a)}var t=function(){function t(e){this.current=1,this.totalPage=1,this.idObj=e;var t=document.getElementById(this.idObj.pagingTemplate).content,n=document.importNode(t,!0);this.pagingBase=n.querySelector("ul");var a=document.getElementById(this.idObj.pagingTemplateOpen).content,i=document.importNode(a,!0);this.pagingOpen=i.querySelectorAll("li");var r=document.getElementById(this.idObj.pagingTemplateClose).content,o=document.importNode(r,!0);this.pagingClose=o.querySelectorAll("li");var g=document.getElementById(this.idObj.pagingFragmentTemplate).content,l=document.importNode(g,!0);this.pagingFragment=l.querySelector("li"),this.pagingNumberObj={close:0,hasNext:!1,hasNextSibling:!1,hasPrev:!1,hasPrevSibling:!1,open:0},this.setEvent()}return t.calcPagingNumber=function(e,t){var n={close:1,hasNext:!1,hasNextSibling:!(e===t),hasPrev:!1,hasPrevSibling:!(1===e),open:1},a=e%10;return n.open=0===a?e-9:e-a+1,0===a?n.close=e:(n.close=e+(10-a),n.close>t&&(n.close=t)),n.open>=11&&(n.hasPrev=!0),0===n.close%10?n.close+1<=t&&(n.hasNext=!0):n.close+1<t&&(n.hasNext=!0),n},t.calcPrevNextPage=function(e,t,n){var a=1;return(a=e+n)<=0&&(a=1),a>t&&(a=t),a},t.prototype.setEvent=function(){var n=this,a=document.getElementById(this.idObj.paging);null!==a&&(a.addEventListener("onsearch",(function(e){var t=e.detail;console.dir(t),n.current=t.page,n.totalPage=t.totalpage,n.buildPaging(t),n.buildMisc(t)}),!1),a.addEventListener("click",(function(a){a.preventDefault();var i=a.target;if(i.classList.contains("page-link")){var r={page:1};if(i.classList.contains("isnum"))r.page=Number(i.textContent);else{var o=Number(i.getAttribute("data-add"));r.page=t.calcPrevNextPage(n.current,n.totalPage,o)}e(n.idObj.form,"searchrequest",r)}}),!1))},t.prototype.buildPaging=function(e){var n=document.getElementById(this.idObj.pagingWrap);if(null===n)throw new Error("mandator element not found");for(;n.lastChild;)n.removeChild(n.lastChild);var a=document.createDocumentFragment();this.pagingNumberObj=t.calcPagingNumber(e.page,e.totalpage);var i=this.pagingOpen[0].cloneNode(!0);this.pagingNumberObj.hasPrev||i.classList.add("disabled"),a.appendChild(i);var r=this.pagingOpen[1].cloneNode(!0);if(this.pagingNumberObj.hasPrevSibling||r.classList.add("disabled"),a.appendChild(r),null===this.pagingFragment)throw new Error("mandator element not found");for(var o=this.pagingNumberObj.open;o<=this.pagingNumberObj.close;o++){var g=this.pagingFragment.cloneNode(!0),l=g.querySelector("a");if(null===l)throw new Error("mandator element not found");l.textContent=o.toString(),o===e.page&&g.classList.add("active"),a.appendChild(g.cloneNode(!0))}var s=this.pagingClose[0].cloneNode(!0);this.pagingNumberObj.hasNextSibling||s.classList.add("disabled"),a.appendChild(s);var d=this.pagingClose[1].cloneNode(!0);if(this.pagingNumberObj.hasNext||d.classList.add("disabled"),a.appendChild(d),null===this.pagingBase)throw new Error("mandator element not found");var p=this.pagingBase.cloneNode(!0);p.appendChild(a),n.appendChild(p)},t.prototype.buildMisc=function(e){var t="全 "+e.total+" 件 ("+e.page+" / "+e.totalpage+" ページ) "+e.perpage+" 件ずつ表示",n=document.getElementById(this.idObj.pagingMisc);if(null===n)throw new Error("mandator element not found");n.textContent=t},t}();document.addEventListener("DOMContentLoaded",(function(){var n={data:[],page:1,perpage:10,total:3,totalpage:1};document.querySelectorAll(".buttons button").forEach((function(t){t.addEventListener("click",(function(t){var a=t.target,i=a.getAttribute("data-page")||"",r=a.getAttribute("data-total")||"";n.totalpage=Number(r),n.page=Number(i),e("paging","onsearch",n)}),!1)}));var a=document.getElementById("searchform");if(null===a)throw new Error("mandatory element not found");a.addEventListener("searchrequest",(function(e){var t=e.detail,n=e.target.querySelector("input");null!==n&&(n.value=t.page.toString())}),!1);new t({form:"searchform",paging:"paging",pagingFragmentTemplate:"paging_fragment",pagingMisc:"paging_misc",pagingTemplate:"paging_template",pagingTemplateClose:"paging_template_close",pagingTemplateOpen:"paging_template_open",pagingWrap:"paging_wrap",reset:"xxxxxxxxx",search:"xxxxxxxxx",table:"xxxxxxxxx",template:"xxxxx"})}),!1)})();